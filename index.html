<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <title>SQL Data Analysis Journey</title>
    <link rel="icon" type="image/png" href="image.png">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            background: #121212;
            color: #eaeaea;
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* Centered page container */
        .page-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        header {
            background: #1e1e1e;
            color: #eaeaea;
            padding: 2rem 2rem;
            text-align: center;
            border-bottom: 1px solid #333;
        }
        header h1 {
            margin-bottom: 1rem;
            font-size: 2.5rem;
            color: #fff;
        }
        header p {
            max-width: 700px;
            margin: 0 auto;
            font-size: 1.1rem;
            color: #bbb;
        }
        section {
            padding: 1rem 0;
        }
        section h2 {
            font-size: 2rem;
            margin-bottom: 1.5rem;
            color: #fff;
            text-align: center;
        }
        .mermaid {
            margin: 0 auto;
            max-width: 900px;
            background: #1e1e1e;
            padding: 2rem;
            border-radius: 12px;
            border: 1px solid #333;
            box-shadow: 0 3px 15px rgba(0,0,0,0.6);
        }
        /* Buttons side by side */
        .button-row {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-bottom: 1rem;
            margin-top: 1rem;
        }
        /* DataFrame table styling */
        .dataframe-container {
            overflow-x: auto;
            border-radius: 12px;
            border: 1px solid #333;
            margin-top: 1rem;
            padding: 1rem;
            width: 100%;
            background-color: #1e1e1e;
        }
        /* The key fix: applying min-width to all tables inside a .dataframe-container */
        .dataframe-container table {
            border-collapse: collapse;
            min-width: 1200px;
            width: max-content;
        }
        .dataframe-container th,
        .dataframe-container td {
            padding: 0.5rem 1rem;
            border: 1px solid #444;
            text-align: left;
            color: #c9d1d9;
        }
        .dataframe-container th {
            background-color: #2a2a2a;
        }
        /* Toggle button styling */
        .toggle-btn {
            background-color: black;
            color: #E0E1DD;
            border: 1px, solid#E0E1DD;
            border-radius: 6px;
            padding: 0.5rem 1rem;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.2s;
        }
        .toggle-btn:hover {
            background-color: #5A189A;
        }
        /* The pre tag for code and info */
        pre {
            background: #1e1e1e;
            color: #eaeaea;
            padding: 1.5rem;
            border-radius: 10px;
            border: 1px solid #333;
            overflow-x: auto;
            white-space: pre-wrap;
            word-wrap: break-word;
            margin-top: 1rem;
        }
        /* Mobile responsive tweaks */
        @media (max-width: 768px) {
            header h1 {
                font-size: 1.8rem;
            }
            header p {
                font-size: 0.95rem;
                padding: 0 1rem;
            }
            section h2 {
                font-size: 1.5rem;
            }
            .mermaid {
                padding: 1rem;
                font-size: 0.9rem;
            }
            .button-row {
                flex-direction: column;
                align-items: center;
            }
            .toggle-btn {
                width: 100%;
                max-width: 300px;
                font-size: 0.9rem;
                padding: 0.6rem;
            }
            pre {
                font-size: 0.85rem;
                padding: 1rem;
            }
        }

        /* Extra small devices (phones under 480px) */
        @media (max-width: 480px) {
            header h1 {
                font-size: 1.5rem;
            }
            header p {
                font-size: 0.85rem;
            }
            section h2 {
                font-size: 1.3rem;
            }
            .dataframe-container table {
                min-width: unset; /* allow table to shrink */
                font-size: 0.8rem;
            }
            .dataframe-container th,
            .dataframe-container td {
                padding: 0.4rem;
            }
        }

    </style>
    <script type="module">
        import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs";
        mermaid.initialize({ startOnLoad: true, theme: "dark" });
    </script>
</head>
<body>
<header>
    <h1>Retail Orders Project Journey</h1>
    <p>
        I couldn‚Äôt find a neat way to represent my entire data analysis lifecycle ‚Äî
        from downloading datasets to cleaning, storing, and analyzing them.
        So I built this page to share the process in one flow.
        It‚Äôs casual, but also structured.
        <div style="margin-top:2rem; font-size:1rem; color:#bbb;">
            <span>Built by <strong>Sharik Hassan</strong></span>
            <br><br>
            <!-- Space for your links -->
            <a href="https://www.linkedin.com/in/sharik-hassan-98329724b/" target="_blank" style="margin:0 1rem; color:#00acee; text-decoration:none;">LinkedIn</a>
            <a href="#" target="_blank" style="margin:0 1rem; color:#f0f0f0; text-decoration:none;">GitHub</a>
        </div>
    </p>
</header>
<section style="max-width:900px; margin:2rem auto; padding:2rem; background:#1e1e1e; border-radius:12px; border:1px solid #333; color:#eaeaea;">
  <h2 style="margin-bottom:1rem; font-size:1.8rem;">Dataset Overview</h2>
  <p style="line-height:1.8; font-size:1.05rem;">
    For this project, I worked with a <strong>Retail Orders dataset</strong> 
    containing detailed information about products, categories, regions, sales, and profits 
    across multiple years.  
    It provided a great foundation for applying SQL queries, trend analysis, 
    and performance comparisons between <strong>2022 and 2023</strong>.
  </p>
</section>

<div class="page-container">
<section>
    <h2>Project Lifecycle</h2>
    <div class="mermaid">
        flowchart LR
        A["Kaggle API<br>(Download Dataset)"] --> B["üêç Python<br>(Data Cleaning)"]
        B --> C["üêò Postgres<br>(Load Cleaned Dataset)"]
        C --> D["üìù SQL Analysis"]
        D --> E["üìä Dashboard / Insights"]
        style A fill:#201F1D,stroke:#ffffff,stroke-width:1px,color:#FFFCF2,rx:15,ry:15
        style B fill:#201F1D,stroke:#ffffff,stroke-width:1px,color:#FFFCF2,rx:15,ry:15
        style C fill:#201F1D,stroke:#ffffff,stroke-width:1px,color:#FFFCF2,rx:15,ry:15
        style D fill:#201F1D,stroke:#ffffff,stroke-width:1px,color:#FFFCF2,rx:15,ry:15
        style E fill:#201F1D,stroke:#ffffff,stroke-width:1px,color:#FFFCF2,rx:15,ry:15
        linkStyle default stroke:#aaa,stroke-width:2px
    </div>
</section>
<section>
    <h2>Step 1: Downloading the Data</h2>
    <p> We start by collecting the dataset using the <strong>Kaggle API</strong>, directly importing it into Python for further analysis.</p>
    <div class="dataframe-container" id="dfContainer">
        <table border="1" class="dataframe pandas-table">
            <thead>
                <tr style="text-align: right;">
                    <th>Order Id</th>
                    <th>Order Date</th>
                    <th>Ship Mode</th>
                    <th>Segment</th>
                    <th>Country</th>
                    <th>City</th>
                    <th>State</th>
                    <th>Postal Code</th>
                    <th>Region</th>
                    <th>Category</th>
                    <th>Sub Category</th>
                    <th>Product Id</th>
                    <th>cost price</th>
                    <th>List Price</th>
                    <th>Quantity</th>
                    <th>Discount Percent</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>1</td>
                    <td>2023-03-01</td>
                    <td>Second Class</td>
                    <td>Consumer</td>
                    <td>United States</td>
                    <td>Henderson</td>
                    <td>Kentucky</td>
                    <td>42420</td>
                    <td>South</td>
                    <td>Furniture</td>
                    <td>Bookcases</td>
                    <td>FUR-BO-10001798</td>
                    <td>240</td>
                    <td>260</td>
                    <td>2</td>
                    <td>2</td>
                </tr>
                <tr>
                    <td>2</td>
                    <td>2023-08-15</td>
                    <td>Second Class</td>
                    <td>Consumer</td>
                    <td>United States</td>
                    <td>Henderson</td>
                    <td>Kentucky</td>
                    <td>42420</td>
                    <td>South</td>
                    <td>Furniture</td>
                    <td>Chairs</td>
                    <td>FUR-CH-10000454</td>
                    <td>600</td>
                    <td>730</td>
                    <td>3</td>
                    <td>3</td>
                </tr>
                <tr>
                    <td>3</td>
                    <td>2023-01-10</td>
                    <td>Second Class</td>
                    <td>Corporate</td>
                    <td>United States</td>
                    <td>Los Angeles</td>
                    <td>California</td>
                    <td>90036</td>
                    <td>West</td>
                    <td>Office Supplies</td>
                    <td>Labels</td>
                    <td>OFF-LA-10000240</td>
                    <td>10</td>
                    <td>10</td>
                    <td>2</td>
                    <td>5</td>
                </tr>
                <tr>
                    <td>4</td>
                    <td>2022-06-18</td>
                    <td>Standard Class</td>
                    <td>Consumer</td>
                    <td>United States</td>
                    <td>Fort Lauderdale</td>
                    <td>Florida</td>
                    <td>33311</td>
                    <td>South</td>
                    <td>Furniture</td>
                    <td>Tables</td>
                    <td>FUR-TA-10000577</td>
                    <td>780</td>
                    <td>960</td>
                    <td>5</td>
                    <td>2</td>
                </tr>
                <tr>
                    <td>5</td>
                    <td>2022-07-13</td>
                    <td>Standard Class</td>
                    <td>Consumer</td>
                    <td>United States</td>
                    <td>Fort Lauderdale</td>
                    <td>Florida</td>
                    <td>33311</td>
                    <td>South</td>
                    <td>Office Supplies</td>
                    <td>Storage</td>
                    <td>OFF-ST-10000760</td>
                    <td>20</td>
                    <td>20</td>
                    <td>2</td>
                    <td>5</td>
                </tr>
                <tr>
                    <td>6</td>
                    <td>2022-03-13</td>
                    <td style="color: red;">Not Available</td>
                    <td>Consumer</td>
                    <td>United States</td>
                    <td>Los Angeles</td>
                    <td>California</td>
                    <td>90032</td>
                    <td>West</td>
                    <td>Furniture</td>
                    <td>Furnishings</td>
                    <td>FUR-FU-10001487</td>
                    <td>50</td>
                    <td>50</td>
                    <td>7</td>
                    <td>3</td>
                </tr>
                <tr>
                    <td>7</td>
                    <td>2022-12-28</td>
                    <td>Standard Class</td>
                    <td>Consumer</td>
                    <td>United States</td>
                    <td>Los Angeles</td>
                    <td>California</td>
                    <td>90032</td>
                    <td>West</td>
                    <td>Office Supplies</td>
                    <td>Art</td>
                    <td>OFF-AR-10002833</td>
                    <td>10</td>
                    <td>10</td>
                    <td>4</td>
                    <td>3</td>
                </tr>
                <tr>
                    <td>8</td>
                    <td>2022-01-25</td>
                    <td>Standard Class</td>
                    <td>Consumer</td>
                    <td>United States</td>
                    <td>Los Angeles</td>
                    <td>California</td>
                    <td>90032</td>
                    <td>West</td>
                    <td>Technology</td>
                    <td>Phones</td>
                    <td>TEC-PH-10002275</td>
                    <td>860</td>
                    <td>910</td>
                    <td>6</td>
                    <td>5</td>
                </tr>
                <tr>
                    <td>9</td>
                    <td>2023-03-23</td>
                    <td style="color: red;">Not Available</td>
                    <td>Consumer</td>
                    <td>United States</td>
                    <td>Los Angeles</td>
                    <td>California</td>
                    <td>90032</td>
                    <td>West</td>
                    <td>Office Supplies</td>
                    <td>Binders</td>
                    <td>OFF-BI-10003910</td>
                    <td>20</td>
                    <td>20</td>
                    <td>3</td>
                    <td>2</td>
                </tr>
                <tr>
                    <td>10</td>
                    <td>2023-05-16</td>
                    <td>Standard Class</td>
                    <td>Consumer</td>
                    <td>United States</td>
                    <td>Los Angeles</td>
                    <td>California</td>
                    <td>90032</td>
                    <td>West</td>
                    <td>Office Supplies</td>
                    <td>Appliances</td>
                    <td>OFF-AP-10002892</td>
                    <td>90</td>
                    <td>110</td>
                    <td>5</td>
                    <td>3</td>
                </tr>
            </tbody>
        </table>
    </div>
    <div class="button-row">
        <div class="info-block">
            <button class="toggle-btn" onclick="toggleBlock(this)">Show Info</button>
            <pre style="display: none;">
&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 9994 entries, 0 to 9993
Data columns (total 16 columns):
0   Order Id          9994 non-null   int64
1   Order Date        9994 non-null   object
2   Ship Mode         9993 non-null   object
3   Segment           9994 non-null   object
4   Country           9994 non-null   object
5   City              9994 non-null   object
6   State             9994 non-null   object
7   Postal Code       9994 non-null   int64
8   Region            9994 non-null   object
9   Category          9994 non-null   object
10  Sub Category      9994 non-null   object
11  Product Id        9994 non-null   object
12  cost price        9994 non-null   int64
13  List Price        9994 non-null   int64
14  Quantity          9994 non-null   int64
15  Discount Percent  9994 non-null   int64
dtypes: int64(6), object(10)
memory usage: 1.2+ MB
            </pre>
        </div>
        <div class="code-block">
            <button class="toggle-btn" onclick="toggleBlock(this)">Show Python Code</button>
            <pre style="display: none;">
#! pip install kaggle
import kaggle
!kaggle datasets download ankitbansal06/retail-orders -f orders.csv
import pandas as pd
# Load into Pandas
df = pd.read_csv("orders.csv", encoding="latin-1")
df.info()
df.head(10)
            </pre>
        </div>
    </div>
</section>
<section>
    <h2>Step 2: Data Cleaning</h2>
    <p>
        <strong>1.</strong> Some values in the <strong>Ship Mode</strong> column are missing or incorrectly labeled.
        We replace <code>'Not Available'</code> and <code>'unknown'</code> with <code>NaN</code> for proper analysis.
    </p>
    <div class="dataframe-container" id="dfContainer">
        <table border="1" class="dataframe pandas-table">
            <thead>
                <tr style="text-align: right;">
                    <th>Order Id</th>
                    <th>Order Date</th>
                    <th>Ship Mode</th>
                    <th>Segment</th>
                    <th>Country</th>
                    <th>City</th>
                    <th>State</th>
                    <th>Postal Code</th>
                    <th>Region</th>
                    <th>Category</th>
                    <th>Sub Category</th>
                    <th>Product Id</th>
                    <th>cost price</th>
                    <th>List Price</th>
                    <th>Quantity</th>
                    <th>Discount Percent</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>1</td>
                    <td>2023-03-01</td>
                    <td>Second Class</td>
                    <td>Consumer</td>
                    <td>United States</td>
                    <td>Henderson</td>
                    <td>Kentucky</td>
                    <td>42420</td>
                    <td>South</td>
                    <td>Furniture</td>
                    <td>Bookcases</td>
                    <td>FUR-BO-10001798</td>
                    <td>240</td>
                    <td>260</td>
                    <td>2</td>
                    <td>2</td>
                </tr>
                <tr>
                    <td>2</td>
                    <td>2023-08-15</td>
                    <td>Second Class</td>
                    <td>Consumer</td>
                    <td>United States</td>
                    <td>Henderson</td>
                    <td>Kentucky</td>
                    <td>42420</td>
                    <td>South</td>
                    <td>Furniture</td>
                    <td>Chairs</td>
                    <td>FUR-CH-10000454</td>
                    <td>600</td>
                    <td>730</td>
                    <td>3</td>
                    <td>3</td>
                </tr>
                <tr>
                    <td>3</td>
                    <td>2023-01-10</td>
                    <td>Second Class</td>
                    <td>Corporate</td>
                    <td>United States</td>
                    <td>Los Angeles</td>
                    <td>California</td>
                    <td>90036</td>
                    <td>West</td>
                    <td>Office Supplies</td>
                    <td>Labels</td>
                    <td>OFF-LA-10000240</td>
                    <td>10</td>
                    <td>10</td>
                    <td>2</td>
                    <td>5</td>
                </tr>
                <tr>
                    <td>4</td>
                    <td>2022-06-18</td>
                    <td>Standard Class</td>
                    <td>Consumer</td>
                    <td>United States</td>
                    <td>Fort Lauderdale</td>
                    <td>Florida</td>
                    <td>33311</td>
                    <td>South</td>
                    <td>Furniture</td>
                    <td>Tables</td>
                    <td>FUR-TA-10000577</td>
                    <td>780</td>
                    <td>960</td>
                    <td>5</td>
                    <td>2</td>
                </tr>
                <tr>
                    <td>5</td>
                    <td>2022-07-13</td>
                    <td>Standard Class</td>
                    <td>Consumer</td>
                    <td>United States</td>
                    <td>Fort Lauderdale</td>
                    <td>Florida</td>
                    <td>33311</td>
                    <td>South</td>
                    <td>Office Supplies</td>
                    <td>Storage</td>
                    <td>OFF-ST-10000760</td>
                    <td>20</td>
                    <td>20</td>
                    <td>2</td>
                    <td>5</td>
                </tr>
                <tr>
                    <td>6</td>
                    <td>2022-03-13</td>
                    <td style="color: green;">NaN</td>
                    <td>Consumer</td>
                    <td>United States</td>
                    <td>Los Angeles</td>
                    <td>California</td>
                    <td>90032</td>
                    <td>West</td>
                    <td>Furniture</td>
                    <td>Furnishings</td>
                    <td>FUR-FU-10001487</td>
                    <td>50</td>
                    <td>50</td>
                    <td>7</td>
                    <td>3</td>
                </tr>
                <tr>
                    <td>7</td>
                    <td>2022-12-28</td>
                    <td>Standard Class</td>
                    <td>Consumer</td>
                    <td>United States</td>
                    <td>Los Angeles</td>
                    <td>California</td>
                    <td>90032</td>
                    <td>West</td>
                    <td>Office Supplies</td>
                    <td>Art</td>
                    <td>OFF-AR-10002833</td>
                    <td>10</td>
                    <td>10</td>
                    <td>4</td>
                    <td>3</td>
                </tr>
                <tr>
                    <td>8</td>
                    <td>2022-01-25</td>
                    <td>Standard Class</td>
                    <td>Consumer</td>
                    <td>United States</td>
                    <td>Los Angeles</td>
                    <td>California</td>
                    <td>90032</td>
                    <td>West</td>
                    <td>Technology</td>
                    <td>Phones</td>
                    <td>TEC-PH-10002275</td>
                    <td>860</td>
                    <td>910</td>
                    <td>6</td>
                    <td>5</td>
                </tr>
                <tr>
                    <td>9</td>
                    <td>2023-03-23</td>
                    <td style="color: green;">NaN</td>
                    <td>Consumer</td>
                    <td>United States</td>
                    <td>Los Angeles</td>
                    <td>California</td>
                    <td>90032</td>
                    <td>West</td>
                    <td>Office Supplies</td>
                    <td>Binders</td>
                    <td>OFF-BI-10003910</td>
                    <td>20</td>
                    <td>20</td>
                    <td>3</td>
                    <td>2</td>
                </tr>
                <tr>
                    <td>10</td>
                    <td>2023-05-16</td>
                    <td>Standard Class</td>
                    <td>Consumer</td>
                    <td>United States</td>
                    <td>Los Angeles</td>
                    <td>California</td>
                    <td>90032</td>
                    <td>West</td>
                    <td>Office Supplies</td>
                    <td>Appliances</td>
                    <td>OFF-AP-10002892</td>
                    <td>90</td>
                    <td>110</td>
                    <td>5</td>
                    <td>3</td>
                </tr>
            </tbody>
        </table>
    </div>
    <div class="button-row" style="display:flex; gap:1rem; flex-wrap:wrap;">
        <div class="info-block">
            <button class="toggle-btn" onclick="toggleBlock(this)">Show Info</button>
            <pre style="display:none;">
# Info about cleaning step
Replaced 'Not Available' and 'unknown' in 'Ship Mode' column with NaN.
Checked unique values using df["Ship Mode"].unique().
            </pre>
        </div>
        <div class="code-block">
            <button class="toggle-btn" onclick="toggleBlock(this)">Show Python Code</button>
            <pre style="display:none;">
import numpy as np
# Replace incorrect values with NaN
df.replace(['Not Available', 'unknown'], np.nan, inplace=True)
# Check unique values
df["Ship Mode"].unique()
# Display first 10 rows
df.head(10)
            </pre>
        </div>
    </div>
    <p>
        <strong>2.</strong> The column names are inconsistent ‚Äî some have spaces, some have mixed capitalization.
        We normalize them by converting to lowercase and replacing spaces with underscores.
    </p>
    <div class="dataframe-container">
        <table style="border-collapse: collapse; min-width:1200px; width:max-content;">
            <thead>
                <tr style="text-align: right;">
                    <th>order_id</th>
                    <th>order_date</th>
                    <th>ship_mode</th>
                    <th>segment</th>
                    <th>country</th>
                    <th>city</th>
                    <th>state</th>
                    <th>postal_code</th>
                    <th>region</th>
                    <th>category</th>
                    <th>sub_category</th>
                    <th>product_id</th>
                    <th>cost_price</th>
                    <th>list_price</th>
                    <th>quantity</th>
                    <th>discount_percent</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>1</td>
                    <td>2023-03-01</td>
                    <td>Second Class</td>
                    <td>Consumer</td>
                    <td>United States</td>
                    <td>Henderson</td>
                    <td>Kentucky</td>
                    <td>42420</td>
                    <td>South</td>
                    <td>Furniture</td>
                    <td>Bookcases</td>
                    <td>FUR-BO-10001798</td>
                    <td>240</td>
                    <td>260</td>
                    <td>2</td>
                    <td>2</td>
                </tr>
                <tr>
                    <td>2</td>
                    <td>2023-08-15</td>
                    <td>Second Class</td>
                    <td>Consumer</td>
                    <td>United States</td>
                    <td>Henderson</td>
                    <td>Kentucky</td>
                    <td>42420</td>
                    <td>South</td>
                    <td>Furniture</td>
                    <td>Chairs</td>
                    <td>FUR-CH-10000454</td>
                    <td>600</td>
                    <td>730</td>
                    <td>3</td>
                    <td>3</td>
                </tr>
                <tr>
                    <td>3</td>
                    <td>2023-01-10</td>
                    <td>Second Class</td>
                    <td>Corporate</td>
                    <td>United States</td>
                    <td>Los Angeles</td>
                    <td>California</td>
                    <td>90036</td>
                    <td>West</td>
                    <td>Office Supplies</td>
                    <td>Labels</td>
                    <td>OFF-LA-10000240</td>
                    <td>10</td>
                    <td>10</td>
                    <td>2</td>
                    <td>5</td>
                </tr>
                <tr>
                    <td>4</td>
                    <td>2022-06-18</td>
                    <td>Standard Class</td>
                    <td>Consumer</td>
                    <td>United States</td>
                    <td>Fort Lauderdale</td>
                    <td>Florida</td>
                    <td>33311</td>
                    <td>South</td>
                    <td>Furniture</td>
                    <td>Tables</td>
                    <td>FUR-TA-10000577</td>
                    <td>780</td>
                    <td>960</td>
                    <td>5</td>
                    <td>2</td>
                </tr>
                <tr>
                    <td>5</td>
                    <td>2022-07-13</td>
                    <td>Standard Class</td>
                    <td>Consumer</td>
                    <td>United States</td>
                    <td>Fort Lauderdale</td>
                    <td>Florida</td>
                    <td>33311</td>
                    <td>South</td>
                    <td>Office Supplies</td>
                    <td>Storage</td>
                    <td>OFF-ST-10000760</td>
                    <td>20</td>
                    <td>20</td>
                    <td>2</td>
                    <td>5</td>
                </tr>
            </tbody>
        </table>
    </div>
    <div class="button-row" style="display:flex; gap:1rem; flex-wrap:wrap;">
        <div class="info-block">
            <button class="toggle-btn" onclick="toggleBlock(this)">Show Info</button>
            <pre style="display:none;">
# Info about column cleaning
Column names converted to lowercase and spaces replaced with underscores.
Example: 'Order Id' ‚Üí 'order_id'
            </pre>
        </div>
        <div class="code-block">
            <button class="toggle-btn" onclick="toggleBlock(this)">Show Python Code</button>
            <pre style="display:none;">
# Convert column names to lowercase and replace spaces with underscores
df.columns = df.columns.str.lower()
df.columns = df.columns.str.replace(' ', '_')
df.head()
            </pre>
        </div>
    </div>
    <p>
    <strong>3.</strong> We calculate <code>discount</code>, <code>sale_price</code>, and <code>profit</code> for each order to understand revenue and margins.
    </p>
    <div class="dataframe-container">
        <table border="1" class="dataframe pandas-table">
            <thead>
                <tr style="text-align: right;">
                <th>order_id</th>
                <th>order_date</th>
                <th>ship_mode</th>
                <th>segment</th>
                <th>country</th>
                <th>city</th>
                <th>state</th>
                <th>postal_code</th>
                <th>region</th>
                <th>category</th>
                <th>sub_category</th>
                <th>product_id</th>
                <th>cost_price</th>
                <th>list_price</th>
                <th>quantity</th>
                <th>discount_percent</th>
                <th style="color: #2ea043;">discount</th>
                <th style="color:#2ea043;">sale_price</th>
                <th style="color: #2ea043;">profit</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                <td>1</td>
                <td>2023-03-01</td>
                <td>Second Class</td>
                <td>Consumer</td>
                <td>United States</td>
                <td>Henderson</td>
                <td>Kentucky</td>
                <td>42420</td>
                <td>South</td>
                <td>Furniture</td>
                <td>Bookcases</td>
                <td>FUR-BO-10001798</td>
                <td>240</td>
                <td>260</td>
                <td>2</td>
                <td>2</td>
                <td>5.2</td>
                <td>254.8</td>
                <td>14.8</td>
                </tr>
                <tr>
                <td>2</td>
                <td>2023-08-15</td>
                <td>Second Class</td>
                <td>Consumer</td>
                <td>United States</td>
                <td>Henderson</td>
                <td>Kentucky</td>
                <td>42420</td>
                <td>South</td>
                <td>Furniture</td>
                <td>Chairs</td>
                <td>FUR-CH-10000454</td>
                <td>600</td>
                <td>730</td>
                <td>3</td>
                <td>3</td>
                <td>21.9</td>
                <td>708.1</td>
                <td>108.1</td>
                </tr>
                <tr>
                <td>3</td>
                <td>2023-01-10</td>
                <td>Second Class</td>
                <td>Corporate</td>
                <td>United States</td>
                <td>Los Angeles</td>
                <td>California</td>
                <td>90036</td>
                <td>West</td>
                <td>Office Supplies</td>
                <td>Labels</td>
                <td>OFF-LA-10000240</td>
                <td>10</td>
                <td>10</td>
                <td>2</td>
                <td>5</td>
                <td>0.5</td>
                <td>9.5</td>
                <td>-0.5</td>
                </tr>
                <tr>
                <td>4</td>
                <td>2022-06-18</td>
                <td>Standard Class</td>
                <td>Consumer</td>
                <td>United States</td>
                <td>Fort Lauderdale</td>
                <td>Florida</td>
                <td>33311</td>
                <td>South</td>
                <td>Furniture</td>
                <td>Tables</td>
                <td>FUR-TA-10000577</td>
                <td>780</td>
                <td>960</td>
                <td>5</td>
                <td>2</td>
                <td>19.2</td>
                <td>940.8</td>
                <td>160.8</td>
                </tr>
                <tr>
                <td>5</td>
                <td>2022-07-13</td>
                <td>Standard Class</td>
                <td>Consumer</td>
                <td>United States</td>
                <td>Fort Lauderdale</td>
                <td>Florida</td>
                <td>33311</td>
                <td>South</td>
                <td>Office Supplies</td>
                <td>Storage</td>
                <td>OFF-ST-10000760</td>
                <td>20</td>
                <td>20</td>
                <td>2</td>
                <td>5</td>
                <td>1.0</td>
                <td>19.0</td>
                <td>-1.0</td>
                </tr>
            </tbody>
            </table>
    </div>
    <div class="button-row" style="display:flex; gap:1rem; flex-wrap:wrap;">
        <div class="info-block">
            <button class="toggle-btn" onclick="toggleBlock(this)">Show Info</button>
            <pre style="display:none;">
# Why we do this:
# - 'discount' helps us know how much we reduced from the list price.
# - 'sale_price' is the actual amount the customer paid.
# - 'profit' tells us the net gain from the sale after subtracting cost.
            </pre>
        </div>
        <div class="code-block">
            <button class="toggle-btn" onclick="toggleBlock(this)">Show Python Code</button>
            <pre style="display:none;">
#now we have to derieve new discount col
df['discount']=df['list_price']*df['discount_percent']*0.01
df['sale_price']=df['list_price']-df['discount']
df['profit']=df['sale_price']-df['cost_price']
df
            </pre>
        </div>
    </div>
    <!-- Step 4: Data Types -->
    <p><strong>4.</strong> Checking data types reveals that some columns need conversion (e.g., order_date should be datetime).</p>
    
    <pre style="background-color:#0d1117; color:#c9d1d9; padding:1rem; border-radius:12px; overflow-x:auto; font-family:'Fira Code', monospace; line-height:1.5;">
order_id           int64
<span style="color: red;">order_date         object</span>
ship_mode          object
segment            object
country            object
city               object
state              object
postal_code          int64
region             object
category           object
sub_category       object
product_id         object
cost_price           int64
list_price           int64
quantity             int64
discount_percent     int64
discount           float64
sale_price         float64
profit             float64
dtype: object
    </pre>

    <div class="button-row" style="display:flex; gap:1rem; flex-wrap:wrap;">
        <div class="info-block">
            <button class="toggle-btn" onclick="toggleBlock(this)">Show Info</button>
            <pre style="display:none;">
Check column data types to ensure correctness.
Convert order_date to datetime for time-based operations.
Correct types before pushing data to SQL server to prevent errors.
            </pre>
        </div>
        <div class="code-block">
            <button class="toggle-btn" onclick="toggleBlock(this)">Show Python Code</button>
            <pre style="display:none;">
#we will be passing it into sql so we can see that dates are like strings so we will be converting it into date format
df['order_date'] = pd.to_datetime(df['order_date'],format="%Y-%m-%d")
            </pre>
        </div>
    </div>
    <pre style="background-color:#0d1117; color:#c9d1d9; padding:1rem; border-radius:12px; overflow-x:auto; font-family:'Fira Code', monospace; line-height:1.5;">
<span style="color:rgb(129, 129, 129) ;">#Output</span>

order_id           int64
<span style="color: green;">order_date         datetime64[ns]</span>
ship_mode          object
segment            object
country            object
city               object
state              object
postal_code          int64
region             object
category           object
sub_category       object
product_id         object
cost_price           int64
list_price           int64
quantity             int64
discount_percent     int64
discount           float64
sale_price         float64
profit             float64
dtype: object
    </pre>

    <p>
    <strong>5.</strong> We remove redundant columns<code> ('list_price', 'cost_price', 'discount_percent')</code> to simplify the dataset and keep only relevant data for analysis and SQL storage.
    </p>
    <div class="dataframe-container">
        <table border="1" class="dataframe pandas-table">
            <thead>
                <tr style="text-align: right;">
                <th>order_id</th>
                <th>order_date</th>
                <th>ship_mode</th>
                <th>segment</th>
                <th>country</th>
                <th>city</th>
                <th>state</th>
                <th>postal_code</th>
                <th>region</th>
                <th>category</th>
                <th>sub_category</th>
                <th>product_id</th>
                <th>quantity</th>
                <th style="color: #2ea043;">discount</th>
                <th style="color:#2ea043;">sale_price</th>
                <th style="color: #2ea043;">profit</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                <td>1</td>
                <td>2023-03-01</td>
                <td>Second Class</td>
                <td>Consumer</td>
                <td>United States</td>
                <td>Henderson</td>
                <td>Kentucky</td>
                <td>42420</td>
                <td>South</td>
                <td>Furniture</td>
                <td>Bookcases</td>
                <td>FUR-BO-10001798</td>
                <td>2</td>
                <td>5.2</td>
                <td>254.8</td>
                <td>14.8</td>
                </tr>
                <tr>
                <td>2</td>
                <td>2023-08-15</td>
                <td>Second Class</td>
                <td>Consumer</td>
                <td>United States</td>
                <td>Henderson</td>
                <td>Kentucky</td>
                <td>42420</td>
                <td>South</td>
                <td>Furniture</td>
                <td>Chairs</td>
                <td>FUR-CH-10000454</td>
                <td>3</td>
                <td>21.9</td>
                <td>708.1</td>
                <td>108.1</td>
                </tr>
                <tr>
                <td>3</td>
                <td>2023-01-10</td>
                <td>Second Class</td>
                <td>Corporate</td>
                <td>United States</td>
                <td>Los Angeles</td>
                <td>California</td>
                <td>90036</td>
                <td>West</td>
                <td>Office Supplies</td>
                <td>Labels</td>
                <td>OFF-LA-10000240</td>
                <td>2</td>
                <td>0.5</td>
                <td>9.5</td>
                <td>-0.5</td>
                </tr>
                <tr>
                <td>4</td>
                <td>2022-06-18</td>
                <td>Standard Class</td>
                <td>Consumer</td>
                <td>United States</td>
                <td>Fort Lauderdale</td>
                <td>Florida</td>
                <td>33311</td>
                <td>South</td>
                <td>Furniture</td>
                <td>Tables</td>
                <td>FUR-TA-10000577</td>
                <td>5</td>
                <td>19.2</td>
                <td>940.8</td>
                <td>160.8</td>
                </tr>
                <tr>
                <td>5</td>
                <td>2022-07-13</td>
                <td>Standard Class</td>
                <td>Consumer</td>
                <td>United States</td>
                <td>Fort Lauderdale</td>
                <td>Florida</td>
                <td>33311</td>
                <td>South</td>
                <td>Office Supplies</td>
                <td>Storage</td>
                <td>OFF-ST-10000760</td>
                <td>2</td>
                <td>1.0</td>
                <td>19.0</td>
                <td>-1.0</td>
                </tr>
            </tbody>
            </table>
    </div>
    <div class="button-row" style="display:flex; gap:1rem; flex-wrap:wrap;">
        <div class="info-block">
            <button class="toggle-btn" onclick="toggleBlock(this)">Show Info</button>
            <pre style="display:none;">
- Drop unnecessary columns ('list_price', 'cost_price', 'discount_percent') to simplify the dataset.
- Keeps only relevant columns for analysis and storage.
- Reduces clutter before pushing data to SQL.
            </pre>
        </div>
        <div class="code-block">
            <button class="toggle-btn" onclick="toggleBlock(this)">Show Python Code</button>
            <pre style="display:none;">
# earlier we have created a lot of unnesscary cols so we will drop them
df.drop(columns=['list_price','cost_price','discount_percent'],inplace=True)
            </pre>
        </div>
    </div>
    
</section>
<section>
  <h2>Step 3: Pushing Cleaned Data into PostgreSQL</h2>
  <p>
    After cleaning, we push the final dataset into a PostgreSQL server for structured storage and future querying.
  </p>

  <pre><code class="language-python">
!pip install psycopg2-binary sqlalchemy
from sqlalchemy import create_engine
import psycopg2

# Create connection engine
engine = create_engine("postgresql://postgres:********@localhost:5432/postgres")

# Suppose your original dataframe was df
df_cleaned = df.copy()

# Perform cleaning
df_cleaned.dropna(inplace=True)
df_cleaned.drop_duplicates(inplace=True)
# (any other cleaning steps you did)

# Push to Postgres
df.to_sql("orders", engine, if_exists="append", index=False)
  </code></pre>
</section>
<section>
    <h2>Data Analysis Using SQL</h2>

    <div class="query-section">
        <p><strong>Display the first five orders with relevant details.</strong> </p>

        <div class="dataframe-container" style="overflow-x:auto; border-radius:12px; border:1px solid #333; margin-top:1rem;">
            <table border="1" class="pandas-table" style="border-collapse:collapse; min-width:100%;">
                <thead>
                    <tr>
                        <th>order_id</th><th>order_date</th><th>ship_mode</th><th>segment</th>
                        <th>country</th><th>city</th><th>state</th><th>postal_code</th>
                        <th>region</th><th>category</th><th>sub_category</th><th>product_id</th>
                        <th>quantity</th><th>discount</th><th>sale_price</th><th>profit</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>1</td><td>2023-03-01</td><td>Second Class</td><td>Consumer</td>
                        <td>United States</td><td>Henderson</td><td>Kentucky</td><td>42420</td>
                        <td>South</td><td>Furniture</td><td>Bookcases</td><td>FUR-BO-10001798</td>
                        <td>2</td><td>5.20</td><td>254.80</td><td>14.80</td>
                    </tr>
                    <tr>
                        <td>2</td><td>2023-08-15</td><td>Second Class</td><td>Consumer</td>
                        <td>United States</td><td>Henderson</td><td>Kentucky</td><td>42420</td>
                        <td>South</td><td>Furniture</td><td>Chairs</td><td>FUR-CH-10000454</td>
                        <td>3</td><td>21.90</td><td>708.10</td><td>108.10</td>
                    </tr>
                    <tr>
                        <td>3</td><td>2023-01-10</td><td>Second Class</td><td>Corporate</td>
                        <td>United States</td><td>Los Angeles</td><td>California</td><td>90036</td>
                        <td>West</td><td>Office Supplies</td><td>Labels</td><td>OFF-LA-10000240</td>
                        <td>2</td><td>0.50</td><td>9.50</td><td>-0.50</td>
                    </tr>
                    <tr>
                        <td>4</td><td>2022-06-18</td><td>Standard Class</td><td>Consumer</td>
                        <td>United States</td><td>Fort Lauderdale</td><td>Florida</td><td>33311</td>
                        <td>South</td><td>Furniture</td><td>Tables</td><td>FUR-TA-10000577</td>
                        <td>5</td><td>19.20</td><td>940.80</td><td>160.80</td>
                    </tr>
                    <tr>
                        <td>5</td><td>2022-07-13</td><td>Standard Class</td><td>Consumer</td>
                        <td>United States</td><td>Fort Lauderdale</td><td>Florida</td><td>33311</td>
                        <td>South</td><td>Office Supplies</td><td>Storage</td><td>OFF-ST-10000760</td>
                        <td>2</td><td>1.00</td><td>19.00</td><td>-1.00</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <button class="toggle-btn" onclick="toggleQuery(this)"style="margin-top: 18px;">View Query</button>
        <pre class="query-block" style="display:none;">
select * from orders
limit 5;
        </pre>
    </div>

    <div class="query-section">
        <p><strong>Q1:</strong>Find top 10 highest revenue generating products</p>

        <div class="dataframe-container" style="overflow-x:auto; border-radius:12px; border:1px solid #333;height: 300px; margin-top:1rem;">
            <table border="1" class="pandas-table" style="border-collapse:collapse; min-width:100%; width:max-content;">
                <thead>
                <tr style="background-color:#1e1e1e; color:#fff; text-align:right;">
                    <th>product_id</th>
                    <th>sales</th>
                </tr>
                </thead>
                <tbody>
                <tr><td>TEC-CO-10004722</td><td>59514.00</td></tr>
                <tr><td>OFF-BI-10003527</td><td>26525.30</td></tr>
                <tr><td>TEC-MA-10002412</td><td>21734.40</td></tr>
                <tr><td>FUR-CH-10002024</td><td>21096.20</td></tr>
                <tr><td>OFF-BI-10001359</td><td>19090.20</td></tr>
                <tr><td>OFF-BI-10000545</td><td>18249.00</td></tr>
                <tr><td>TEC-CO-10001449</td><td>18151.20</td></tr>
                <tr><td>TEC-MA-10001127</td><td>17906.40</td></tr>
                <tr><td>OFF-BI-10004995</td><td>17354.80</td></tr>
                <tr><td>OFF-SU-10000151</td><td>16325.80</td></tr>
                </tbody>
            </table>
            </div>


        <button class="toggle-btn" onclick="toggleQuery(this)"style="margin-top: 18px;">View Query</button>
        <pre class="query-block" style="display:none;">
select  product_id,sum(sale_price) as sales
from orders
group by product_id
order by sales desc
limit 10;
        </pre>
    </div>
    <div class="query-section">
        <p><strong>Q2:</strong>Find top 5 highest  selling products in each region</p>

        <div class="dataframe-container" style="overflow-x:auto; border-radius:12px; border:1px solid #333;height: 300px; margin-top:1rem;">
            <table border="1" class="pandas-table" style="border-collapse:collapse; min-width:100%; width:max-content;">
                <thead>
                <tr style="background-color:#1e1e1e; color:#fff; text-align:right;">
                    <th>region</th>
                    <th>product_id</th>
                    <th>sales</th>
                    <th>rn</th>
                </tr>
                </thead>
                <tr><td>Central</td><td>TEC-CO-10004722</td><td>16975.00</td><td>1</td></tr>
                <tr><td>Central</td><td>TEC-MA-10000822</td><td>13770.00</td><td>2</td></tr>
                <tr><td>Central</td><td>OFF-BI-10001120</td><td>11056.50</td><td>3</td></tr>
                <tr><td>Central</td><td>OFF-BI-10000545</td><td>10132.70</td><td>4</td></tr>
                <tr><td>Central</td><td>OFF-BI-10004995</td><td>8416.10</td><td>5</td></tr>
                <tr><td>East</td><td>TEC-CO-10004722</td><td>29099.00</td><td>1</td></tr>
                <tr><td>East</td><td>TEC-MA-10001047</td><td>13767.00</td><td>2</td></tr>
                <tr><td>East</td><td>FUR-BO-10004834</td><td>11274.10</td><td>3</td></tr>
                <tr><td>East</td><td>OFF-BI-10001359</td><td>8463.60</td><td>4</td></tr>
                <tr><td>East</td><td>TEC-CO-10001449</td><td>8316.00</td><td>5</td></tr>
                <tr><td>South</td><td>TEC-MA-10002412</td><td>21734.40</td><td>1</td></tr>
                <tr><td>South</td><td>TEC-MA-10001127</td><td>11116.40</td><td>2</td></tr>
                <tr><td>South</td><td>OFF-BI-10001359</td><td>8053.20</td><td>3</td></tr>
                <tr><td>South</td><td>TEC-MA-10004125</td><td>7840.00</td><td>4</td></tr>
                <tr><td>South</td><td>OFF-BI-10003527</td><td>7391.40</td><td>5</td></tr>
                <tr><td>West</td><td>TEC-CO-10004722</td><td>13440.00</td><td>1</td></tr>
                <tr><td>West</td><td>OFF-SU-10000151</td><td>12592.30</td><td>2</td></tr>
                <tr><td>West</td><td>FUR-CH-10001215</td><td>9604.00</td><td>3</td></tr>
                <tr><td>West</td><td>OFF-BI-10003527</td><td>7804.80</td><td>4</td></tr>
                <tr><td>West</td><td>TEC-AC-10003832</td><td>7722.70</td><td>5</td></tr>
                </tbody>
            </table>
            </div>


        <button class="toggle-btn" onclick="toggleQuery(this)"style="margin-top: 18px;">View Query</button>
        <pre class="query-block" style="display:none;">
with cte as ( 
select region,product_id,sum(sale_price) as sales
from orders
group by region, product_id)
select *from (
select * 
, row_number() over(partition by region order by sales desc) as rn
from cte) A
where rn <=5;
        </pre>
    </div>

    <div class="query-section">
        <p><strong>Q3:</strong>Find month over month growth comparision for 2022 and 2023 sales eg: jan 2022 vs 2023</p>

        <div class="dataframe-container" style="overflow-x:auto; border-radius:12px; border:1px solid #333;height: 300px; margin-top:1rem;">
            <table border="1" class="pandas-table" style="border-collapse:collapse; min-width:100%; width:max-content;">
                <thead>
                <tr style="background-color:#1e1e1e; color:#fff; text-align:right;">
                    <th>order_month</th>
                    <th>sales_2022</th>
                    <th>sales_2023</th>
                </tr>
                </thead>
                <tbody>
                <tr><td>1</td><td>94712.50</td><td>88632.60</td></tr>
                <tr><td>2</td><td>90091.00</td><td>128124.20</td></tr>
                <tr><td>3</td><td>80106.00</td><td>82512.30</td></tr>
                <tr><td>4</td><td>95451.60</td><td>111568.60</td></tr>
                <tr><td>5</td><td>79448.30</td><td>86447.90</td></tr>
                <tr><td>6</td><td>94170.50</td><td>68976.50</td></tr>
                <tr><td>7</td><td>78652.20</td><td>90563.80</td></tr>
                <tr><td>8</td><td>104808.00</td><td>87733.60</td></tr>
                <tr><td>9</td><td>79142.20</td><td>76658.60</td></tr>
                <tr><td>10</td><td>118912.70</td><td>121061.50</td></tr>
                <tr><td>11</td><td>84225.30</td><td>75432.80</td></tr>
                <tr><td>12</td><td>95869.90</td><td>102556.10</td></tr>
                </tbody>
            </table>
            </div>



        <button class="toggle-btn" onclick="toggleQuery(this)"style="margin-top: 18px;">View Query</button>
        <pre class="query-block" style="display:none;">
with cte as(
select extract(year from order_date) as order_year,extract(month from order_date) as order_month,
sum(sale_price) as sales
from orders
group by order_year, order_month
--order by order_year, order_month
)
select order_month
,sum(case when order_year=2022 then sales else 0 end) as sales_2022
,sum(case when order_year=2023 then sales else 0 end) as sales_2023
from cte 
group by order_month
order by order_month
        </pre>
    </div>
        <div class="query-section">
        <p><strong>Q4:</strong>For each category which month had the highest sales?</p>

        <div class="dataframe-container" style="overflow-x:auto; border-radius:12px; border:1px solid #333; margin-top:1rem;">
            <table border="1" class="pandas-table" style="border-collapse:collapse; min-width:100%; width:max-content;">
                <thead>
                <tr style="background-color:#1e1e1e; color:#fff; text-align:right;">
                    <th>category</th>
                    <th>order_year_month</th>
                    <th>sales</th>
                    <th>rn</th>
                </tr>
                </thead>
                <tbody>
                <tr><td>Furniture</td><td>202210</td><td>42888.90</td><td>1</td></tr>
                <tr><td>Office Supplies</td><td>202302</td><td>44118.50</td><td>1</td></tr>
                <tr><td>Technology</td><td>202310</td><td>53000.10</td><td>1</td></tr>
                </tbody>
            </table>
            </div>




        <button class="toggle-btn" onclick="toggleQuery(this)"style="margin-top: 18px;">View Query</button>
        <pre class="query-block" style="display:none;">
with cte as (
select category, to_char(order_date, 'YYYYMM') as order_year_month,
sum(sale_price) as sales
from orders
group by category,to_char(order_date, 'YYYYMM')
order by category,to_char(order_date, 'YYYYMM')
)
select * from(
select *,
row_number() over(partition by category order by sales desc) as rn
from cte
) a
where rn=1
        </pre>
    </div>
    <div class="query-section">
        <p><strong>Q5:</strong>Which sub category had the highest growth (percentage) by profit in 2023 compare to 2022?
</p>

        <div class="dataframe-container" style="overflow-x:auto; border-radius:12px; border:1px solid #333; margin-top:1rem;">
            <table border="1" class="pandas-table" style="border-collapse:collapse; min-width:100%; width:max-content;">
                <thead>
                <tr style="background-color:#1e1e1e; color:#fff; text-align:right;">
                    <th>sub_category</th>
                    <th>sales_2022</th>
                    <th>sales_2023</th>
                    <th>percentage</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td>Supplies</td>
                    <td>16140.70</td>
                    <td>28917.40</td>
                    <td>79.16</td>
                </tr>
                </tbody>
            </table>
            </div>




        <button class="toggle-btn" onclick="toggleQuery(this)"style="margin-top: 18px;">View Query</button>
        <pre class="query-block" style="display:none;">
with cte as(
select sub_category ,extract(year from order_date) as order_year,
sum(sale_price) as sales
from orders
group by sub_category,order_year
)
,cte2 as (
select sub_category
,sum(case when order_year=2022 then sales else 0 end) as sales_2022
,sum(case when order_year=2023 then sales else 0 end) as sales_2023
from cte 
group by sub_category
)
select *
,(sales_2023-sales_2022)*100/(sales_2022) as percentage
from cte2
order by answer desc
limit 1

        </pre>
    </div>
</section>

<section id="retail-dashboard" style="padding: 40px;"> 
  <h2 style="text-align:center; font-family: Inter, sans-serif; margin-bottom: 20px;">
    Retail Sales Dashboard (2022‚Äì2023)
  </h2>

  <div class='tableauPlaceholder' id='viz1755896599595' style='position: relative; margin: auto; max-width: 95%;'>
    <object class='tableauViz' style='display:none; width:100%; height:900px;'>
      <param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> 
      <param name='embed_code_version' value='3' /> 
      <param name='path' value='views/Retail_order/Retail_Dashboard?:language=en-US&amp;:embed=true&amp;publish=yes' /> 
      <param name='toolbar' value='yes' />
      <param name='animate_transition' value='yes' />
      <param name='display_spinner' value='yes' />
      <param name='display_overlay' value='yes' />
      <param name='display_count' value='yes' />
      <param name='language' value='en-US' />
      <param name='filter' value='publish=yes' />
    </object>
  </div>

  <p style="text-align:center; margin-top: 20px; font-family: Inter, sans-serif;">
    <a href="https://public.tableau.com/app/profile/sharik.hassan2405/viz/Retail_order/Retail_Dashboard" 
          target="_blank" 
          style="color:#0073e6; text-decoration:none; font-weight:600;">
      View on Tableau Public
    </a>
  </p>

  <script type='text/javascript'>                    
    var divElement = document.getElementById('viz1755896599595');                    
    var vizElement = divElement.getElementsByTagName('object')[0];                    
    vizElement.style.width = "100%";  
    vizElement.style.height = "900px";  

    var scriptElement = document.createElement('script');                    
    scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';                    
    vizElement.parentNode.insertBefore(scriptElement, vizElement);                
  </script>
</section>


<section>
  <h2>Conclusion & Insights</h2>
  <div class="insights-container" style="background:#1e1e1e; padding:2rem; border-radius:12px; border:1px solid #333; max-width:900px; margin:1rem auto; color:#eaeaea;">
    <ul style="line-height:1.8; font-size:1.1rem;">
      <li><strong>Top Selling Products & Regions:</strong> Technology and Office Supplies dominate sales across all regions.</li>
      <li><strong>Monthly Trends:</strong> Certain months like October and February show peaks in sales, indicating seasonal demand.</li>
      <li><strong>Growth Analysis:</strong> 2023 shows notable increases in specific categories and sub-categories compared to 2022.</li>
      <li><strong>Data Quality & Cleaning:</strong> Cleaning missing values, normalizing column names, and calculating profits ensures accurate reporting and SQL integration.</li>
      <li><strong>Next Steps:</strong> Build dashboards for real-time insights, and consider predictive modeling for sales forecasting.</li>
    </ul>
  </div>
</section>


<script>
    function toggleQuery(button) {
        // Find the parent div with class 'query-section'
        const querySection = button.closest('.query-section');
        // Find the pre element within that div
        const queryBlock = querySection.querySelector('.query-block');
        
        if (queryBlock.style.display === "none") {
            queryBlock.style.display = "block";
            button.textContent = "Hide Query";
        } else {
            queryBlock.style.display = "none";
            button.textContent = "View Query";
        }
    }
</script>
<script>
  function toggleQuery(button){
    const pre = button.nextElementSibling;
    if(pre.style.display === "none" || pre.style.display === ""){
      pre.style.display = "block";
      button.textContent = "Hide Query";
    } else {
      pre.style.display = "none";
      button.textContent = "View Query";
    }
  }
</script>




<script>
    // Toggle function for Info and Python code
    function toggleBlock(button) {
        const parent = button.parentElement;
        const pre = parent.querySelector('pre');
        const isInfoButton = button.textContent.includes('Info');
        
        if (pre.style.display === "none" || pre.style.display === "") {
            pre.style.display = "block";
            button.textContent = `Hide ${isInfoButton ? 'Info' : 'Python Code'}`;
        } else {
            pre.style.display = "none";
            button.textContent = `Show ${isInfoButton ? 'Info' : 'Python Code'}`;
        }
    }
</script>
</body>
</html>
